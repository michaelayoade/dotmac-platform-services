# Hybrid Deployment Mode (Multi-Region with Control Plane)
# Copy this file to .env and update with your values
# NOTE: Use separate .env files for control plane vs tenant instances

# ============================================
# DEPLOYMENT MODE
# ============================================
DEPLOYMENT_MODE=hybrid

# Control Plane: Set to True
# Tenant Instance: Set to False
ENABLE_PLATFORM_ROUTES=True

# ============================================
# APPLICATION
# ============================================
APP_VERSION=1.0.0
ENVIRONMENT=staging
HOST=0.0.0.0
PORT=8000

# ============================================
# DATABASE
# ============================================
# Control Plane: Central database
# Tenant Instance: Regional database per instance
DATABASE_URL=postgresql://dotmac_user:CHANGE_ME_IN_PRODUCTION@localhost:5432/dotmac
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=10

# ============================================
# REDIS
# ============================================
# Control Plane: Central Redis
# Tenant Instance: Regional Redis per instance
REDIS_URL=redis://:CHANGE_ME_IN_PRODUCTION@localhost:6379/0
REDIS_MAX_CONNECTIONS=50

# ============================================
# SECURITY
# ============================================
SECRET_KEY=CHANGE_ME_TO_RANDOM_64_CHAR_STRING
JWT_SECRET_KEY=CHANGE_ME_TO_RANDOM_64_CHAR_STRING
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ============================================
# CORS
# ============================================
CORS_ENABLED=True
# Control Plane: Platform admin URLs
# Tenant Instance: ISP operation URLs per region
CORS_ORIGINS=http://localhost:3000,https://platform.dotmac.io,https://us-east.dotmac.io,https://eu-west.dotmac.io
CORS_CREDENTIALS=True
CORS_METHODS=GET,POST,PUT,PATCH,DELETE,OPTIONS
CORS_HEADERS=*

# ============================================
# OBSERVABILITY
# ============================================
ENABLE_METRICS=True
ENABLE_TRACES=True
LOG_LEVEL=INFO
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317

# ============================================
# STORAGE (MinIO/S3)
# ============================================
STORAGE_PROVIDER=minio
# Control Plane: Central storage
# Tenant Instance: Regional storage per instance
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=CHANGE_ME_IN_PRODUCTION
MINIO_BUCKET=dotmac
MINIO_SECURE=False

# ============================================
# EMAIL
# ============================================
SMTP_HOST=localhost
SMTP_PORT=587
SMTP_USER=noreply@dotmac.io
SMTP_PASSWORD=CHANGE_ME_IN_PRODUCTION
SMTP_USE_TLS=True
SMTP_FROM_EMAIL=noreply@dotmac.io
SMTP_FROM_NAME=DotMac Platform

# ============================================
# VAULT/OPENBAO (Optional)
# ============================================
VAULT_ENABLED=False
VAULT_URL=http://localhost:8200
VAULT_TOKEN=CHANGE_ME_IN_PRODUCTION
VAULT_MOUNT_PATH=secret

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_DEFAULT=100/minute

# ============================================
# HYBRID MODE SPECIFIC
# ============================================

# --- CONTROL PLANE SETTINGS (if ENABLE_PLATFORM_ROUTES=True) ---
# Control plane URL for tenant instances to connect
CONTROL_PLANE_URL=https://platform.dotmac.io

# Platform admin settings
PLATFORM_ADMIN_EMAIL=admin@dotmac.io
PLATFORM_SUPPORT_EMAIL=support@dotmac.io

# Tenant provisioning
AUTO_PROVISION_TENANT_INSTANCES=True
DEFAULT_TENANT_REGION=us-east-1

# --- TENANT INSTANCE SETTINGS (if ENABLE_PLATFORM_ROUTES=False) ---
# Region identifier for this tenant instance
INSTANCE_REGION=us-east-1

# Control plane connection
CONTROL_PLANE_API_KEY=CHANGE_ME_CONTROL_PLANE_API_KEY
CONTROL_PLANE_SYNC_INTERVAL=300  # seconds

# Regional settings
REGIONAL_DATABASE_URL=postgresql://dotmac_user:CHANGE_ME@db-us-east:5432/dotmac
REGIONAL_REDIS_URL=redis://:CHANGE_ME@redis-us-east:6379/0
REGIONAL_STORAGE_ENDPOINT=s3-us-east-1.amazonaws.com

# Data residency compliance
DATA_RESIDENCY_COUNTRY=US
DATA_RESIDENCY_REGION=us-east-1
