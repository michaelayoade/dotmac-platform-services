query AuditEventsQuery($filter: AuditEventFilter, $first: Int, $after: String) {
  auditEvents(filter: $filter, first: $first, after: $after) {
    nodes {
      id
      timestamp
      category
      level
      action
      resource
      actor
      tenantId
      ipAddress
      userAgent
      details
      outcome
    }
    pageInfo {
      hasNextPage
      hasPreviousPage
      startCursor
      endCursor
      totalCount
    }
  }
}

query AuditEventQuery($eventId: String!) {
  auditEvent(eventId: $eventId) {
    id
    timestamp
    category
    level
    action
    resource
    actor
    tenantId
    ipAddress
    userAgent
    details
    outcome
  }
}

mutation LogAuditEventMutation(
  $category: AuditCategory!,
  $level: AuditLevel!,
  $action: String!,
  $resource: String!,
  $details: JSON
) {
  logAuditEvent(
    category: $category,
    level: $level,
    action: $action,
    resource: $resource,
    details: $details
  ) {
    id
    timestamp
    category
    level
    action
    resource
    actor
    tenantId
    ipAddress
    userAgent
    details
    outcome
  }
}

subscription AuditEventsStreamSubscription($filter: AuditEventFilter) {
  auditEventsStream(filter: $filter) {
    id
    timestamp
    category
    level
    action
    resource
    actor
    tenantId
    ipAddress
    userAgent
    details
    outcome
  }
}