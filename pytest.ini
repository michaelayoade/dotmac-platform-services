[pytest]
# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test paths
testpaths = tests

# Pytest options
# Default: Run fast core tests (unit tests without slow/comprehensive markers)
# Use -m "" to run all tests, or -m "comprehensive" for edge cases only
addopts =
    -ra
    --strict-markers
    --ignore=tests/archive/
    --ignore=tests/performance/
    --ignore=tests/test_real_services.py
    --ignore=tests/test_observability.py
    --ignore=tests/search/test_service.py
    --ignore=tests/search/test_router.py

# Markers for test categorization
# Run specific categories: pytest -m unit, pytest -m comprehensive, etc.
markers =
    unit: Fast unit tests (<0.1s) - default execution
    integration: Integration tests requiring external services (medium, <1s)
    slow: Slow running tests (>1s) - excluded from default runs
    comprehensive: Comprehensive edge case tests - optional validation
    skip: Skip test temporarily
    auth: Authentication and authorization tests
    secrets: Secrets management tests
    performance: Performance and load tests (excluded by default)
    benchmark: Performance benchmark tests
    e2e: End-to-end workflow tests
    observability: Observability and telemetry tests
    chaos: Chaos engineering tests
    contract: API contract tests
    serial: Tests that must run sequentially (not in parallel with pytest-xdist)

# Test Execution Strategies:
#   Fast CI (default):     pytest tests/
#   Comprehensive CI:      pytest tests/ -m "comprehensive"
#   Integration tests:     pytest tests/ -m "integration"
#   Full suite:            pytest tests/ -m ""
#   Module-specific:       pytest tests/billing/ -v

# Asyncio - auto mode for better compatibility
asyncio_mode = auto

# Filter warnings
filterwarnings =
    ignore::RuntimeWarning
    ignore::DeprecationWarning
    ignore::pytest.PytestUnraisableExceptionWarning
    ignore::UserWarning

# Logging
log_cli = false
log_cli_level = INFO

# Coverage configuration
# Use --cov flag when needed
# Overall target: 80% coverage
# Module-specific targets:
#   auth: 85%, billing: 80%, communications: 75%
#   data_transfer: 80%, customer_management: 75%
#   webhooks: 75%, search: 70%, monitoring: 70%